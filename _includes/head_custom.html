<link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

<script>
document.addEventListener('DOMContentLoaded', () => {
  // ====== Título del panel lateral ======
  const SITE_TITLE_TEXT = 'Idle Runner — One Page GDD';
  const siteTitle = document.querySelector('.site-title');
  if (siteTitle) siteTitle.textContent = SITE_TITLE_TEXT;

  // ====== Construir índice (H2) en la navegación izquierda ======
  const navUL =
    document.querySelector('.side-bar .navigation .navigation-list') ||
    document.querySelector('.side-bar .navigation-list') ||
    document.querySelector('.side-bar nav ul');

  if (navUL) {
    navUL.innerHTML = '';
    const h2s = Array.from(document.querySelectorAll('.main-content h2'));
    if (h2s.length) {
      h2s.forEach(sec => {
        if (!sec.id) {
          sec.id = sec.textContent.trim()
                     .toLowerCase()
                     .replace(/[^\w\s-]/g,'')
                     .replace(/\s+/g,'-');
        }
        const li = document.createElement('li');
        li.className = 'navigation-list-item';
        const a = document.createElement('a');
        a.className = 'navigation-list-link';
        a.href = '#' + sec.id;
        a.textContent = sec.textContent.replace(/^\s*[\W_]+/, '');
        li.appendChild(a);
        navUL.appendChild(li);
      });
    } else {
      const li = document.createElement('li');
      li.className = 'navigation-list-item';
      li.innerHTML = '<a class="navigation-list-link" href="#gdd">Contenido</a>';
      navUL.appendChild(li);
    }
  }

  // ====== Toggle de la sidebar (botón está dentro de la quickbar) ======
  const toggleBtn = document.querySelector('.quickbar .sidebar-toggle');
  if (toggleBtn) {
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('sidebar-collapsed');
    });
  }
});
</script>
